5.公平锁/非公平锁，可重入锁，递归锁，自旋锁 谈谈理解，请写一个自旋锁



## 公平

公平锁：多个线程按照申请锁的顺序来获取锁，类似排队打饭，先来后到

非公平锁：有的线程能优先获取，高并发情况下会造成优先级翻转或者饥饿现象



并发包中reentrantlock默认为非公平

公平锁的实现，在并发模式下线程获取锁机会查看锁维护的等待队列，如果为空，就占有锁

否则就FIFO（队列实现）



非公平锁上来直接尝试占有锁，如果失败，再排队



非公平优点：吞吐量比公平锁大

synchronized 也是一种非公平锁



## 可重入锁（递归锁）

同一线程外层获得锁之后，内层的递归函数任然可以获取到该锁的代码

在同一个线程在外层获取锁的时候，进入内部能自动获取到锁

也就是说，线程可以进入任何一个他已经拥有的锁 所同步着的代码块







reentrantlock和synchronized就是典型的可重入锁

最大作用：避免死锁





27完